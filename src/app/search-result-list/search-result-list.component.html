<section class="lls-results-header">
    <div class="lls-container">
        <div class="lls-results-header__right-section">
            <a routerLink="/user/search-history" class="lls-results-header__history-link">
                Min søgehistorik
            </a>
        </div>
        <form (ngSubmit)="search()" class="lls-row">
            <div class="lls-columns-12 lls-columns-6--md lls-columns-8--lg lls-columns-9--xl">
                <div class="lls-row lls-row--align-bottom">
                    <label class="lls-results-header__field-label lls-columns-12 lls-columns-6--md lls-columns-4--lg lls-columns-2--xl" *ngFor="let searchTerm of searchTerms; index as i;">
                        <span class="lls-results-header__field-label-text">{{ searchFieldLabels[searchTerm.field] }}</span>
                        <input
                            [(ngModel)]="searchTerm.value"
                            type="text"
                            [placeholder]="searchFieldPlaceholders[searchTerm.field]"
                            class="lls-input-field"
                            [name]="'searchterm-value-' + i"
                        />
                    </label>
                    <div class="lls-results-header__field-label lls-columns-12 lls-columns-6--md lls-columns-4--lg lls-columns-2--xl">
                        <lls-dropdown
                            class="lls-dropdown--option-adder"
                            [options]="fieldOptions"
                            name="add-field"
                            label="Tilføj felt"
                            [featherIconPath]="config.featherIconPath"
                            dropdownIcon="plus-circle"
                            dropdownIconOpen="plus-circle"
                            (change)="addField($event)"
                        ></lls-dropdown>
                        <!-- TODO: on selection made, show label -->
                    </div>
                </div>
            </div>
            <div class="lls-results-header__field-label lls-columns-12 lls-columns-3--md lls-columns-2--lg lls-columns-2--xl">
                <span class="lls-results-header__field-label-text">Resultattype</span>
                <div class="lls-results-header__checkboxes">
                    <div class="lls-results-header__checkbox-container">
                        <input
                            [(ngModel)]="indexSource"
                            type="checkbox"
                            class="lls-results-header__checkbox"
                            id="indexSource-checkbox"
                            name="indexSource"
                        >
                        <label for="indexSource-checkbox">Kilder</label>
                    </div>
                    <div class="lls-results-header__checkbox-container">
                        <input
                            [(ngModel)]="indexLifecourse"
                            type="checkbox"
                            class="lls-results-header__checkbox"
                            id="indexLifecourse-checkbox"
                            name="indexLifecourse"
                        >
                        <label for="indexLifecourse-checkbox">Livsforløb</label>
                    </div>
                </div>
            </div>
            <div class="lls-results-header__right-section lls-columns-12 lls-columns-3--md lls-columns-2--lg lls-columns-1--xl">
                <button
                    type="submit"
                    class="lls-btn lls-btn--blue"
                >
                    <span>Søg</span>
                    <svg class="lls-icon lls-icon--right">
                        <use [attr.href]="featherSpriteUrl + '#search'"></use>
                    </svg>
                </button>
            </div>
        </form>
    </div>
</section>
<section class="lls-results-filter lls-container">
    <div class="lls-row">
        <div class="lls-columns-6 u-p-2">
            <p>Filter resultater</p>
            <button class="lls-btn lls-btn--outline lls-btn--link" (click)="openSidebar = true">
                <span>Kilder</span>
                <svg class="lls-icon lls-icon--right">
                    <use [attr.href]="featherSpriteUrl + '#chevron-right'"></use>
                </svg>
            </button>
            <lls-filter-sidebar
                [openSidebar]="openSidebar"
                [featherIconPath]="config.featherIconPath"
                (closeSidebar)="onClose($event)"
                (change)="addFilter($event)"
            ></lls-filter-sidebar>
            <div class="lls-results-filter__items">
                <button
                    *ngFor="let filterItem of filterItems; index as i;"
                    class="lls-btn lls-btn--small lls-btn--grey u-mr-2 u-mt-2"
                >
                    <span>{{ filterItem.label }}</span>
                    <svg class="lls-icon lls-icon--right" (click)="removeFilter(filterItem)">
                        <use [attr.href]="config.featherIconPath + '#x'"></use>
                      </svg>
                </button>
            </div>
        </div>
        <div class="lls-columns-6 u-p-2">
            <div class="u-text-right">Viser 10 af {{ searchResult.totalHits }} resultater</div>
        </div>
    </div>
</section>
<div class="lls-container">
    <div class="lls-row">
        <div class="lls-columns-6 lls-search-modifiers">
            <!-- Filtering -->
        </div>
        <div class="lls-columns-6 lls-search-modifiers lls-search-modifiers--right">
            <div class="lls-search-modifier-inputs lls-search-modifier-inputs">
                <!--label class="lls-search-modifier-inputs__entry">
                    <span class="lls-search-modifier-inputs__label">Antal per side</span>
                    <lls-dropdown></lls-dropdown>
                </label-->
                <label class="lls-search-modifier-inputs__entry lls-search-modifier-inputs__entry--basis-200">
                    <span class="lls-search-modifier-inputs__label">Sorter efter</span>
                    <lls-dropdown
                        class="lls-dropdown--grey"
                        [options]="sortByOptions"
                        [(ngModel)]="sortBy"
                        [featherIconPath]="featherSpriteUrl"
                    ></lls-dropdown>
                </label>
                <label class="lls-search-modifier-inputs__entry">
                    <span class="lls-search-modifier-inputs__label">&nbsp;</span>
                    <lls-boolean
                        [(ngModel)]="sortAscending"
                        [featherIconPath]="featherSpriteUrl"
                        iconFalse="arrow-up"
                        iconTrue="arrow-down"
                    ></lls-boolean>
                </label>
            </div>
            <div class="u-mt-2" [innerHTML]="resultRangeDescription"></div>
        </div>
    </div>

    <ng-container *ngFor="let hit of searchResult.hits" [ngSwitch]="hit.type">
        <app-person-appearance-item *ngSwitchCase="'pas'" class="mx-2" [item]="hit.pa"></app-person-appearance-item>
        <app-life-course-item *ngSwitchCase="'lifecourses'" class="mx-2" [item]="hit.pas" [lifecourse-id]="hit.life_course_id"></app-life-course-item>
    </ng-container>

    <nav>
        <div class="lls-pagination">
            <a class="lls-pagination__item" [ngClass]="{ 'lls-pagination__item--disabled': pagination.current === 1}" [tabindex]=" pagination.current === 1 ? -1 : 0" [routerLink]="['./', { 'size': pagination.size, 'page': pagination.current - 1 } ]" [queryParams]="queryParams">
                <svg class="lls-icon">
                    <use [attr.href]="featherSpriteUrl + '#arrow-left'"></use>
                </svg>
            </a>

            <ng-container *ngIf="pagination.firstInOrder > 1">
                <a class="lls-pagination__item" [routerLink]="['./', { 'size': pagination.size, 'page': 1 } ]" [queryParams]="queryParams">
                    <span class="lls-pagination__item-text">1</span>
                </a>

                <div class="lls-pagination__entry" *ngIf="pagination.firstInOrder > 2">&mdash;</div>
            </ng-container>
            
            <a class="lls-pagination__item" *ngFor="let page of pagination.navigationPages" [ngClass]="{ 'lls-pagination__item--selected': pagination.current === page }" [routerLink]="['./', { 'size': pagination.size, 'page': page } ]" [queryParams]="queryParams">
                <span class="lls-pagination__item-text">{{ page }}</span>
            </a>

            <ng-container *ngIf="pagination.lastInOrder < pagination.last">
                <div class="lls-pagination__entry" *ngIf="pagination.lastInOrder < pagination.last - 1">&mdash;</div>

                <a class="lls-pagination__item" [routerLink]="['./', { 'size': pagination.size, 'page': pagination.last } ]" [queryParams]="queryParams">
                    <span class="lls-pagination__item-text">{{ pagination.last }}</span>
                </a>
            </ng-container>

            <a class="lls-pagination__item" [ngClass]="{ 'lls-pagination__item--disabled': pagination.current >= pagination.last }" [tabindex]="pagination.current >= pagination.last ? -1 : 0"  [routerLink]="['./', { 'size': pagination.size, 'page': pagination.current + 1 } ]" [queryParams]="queryParams">
                <svg class="lls-icon">
                    <use [attr.href]="featherSpriteUrl + '#arrow-right'"></use>
                </svg>
            </a>
        </div>
    </nav>
</div>
