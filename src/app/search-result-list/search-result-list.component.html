<section class="lls-results-header">
    <div class="lls-container">
        <div class="lls-results-header__right-section">
            <a routerLink="/user/search-history" class="lls-results-header__history-link">
                Min søgehistorik
            </a>
        </div>
        <form (ngSubmit)="search()" class="lls-row">
            <div class="lls-columns-12 lls-columns-6--md lls-columns-8--lg lls-columns-9--xl">
                <div class="lls-row lls-row--align-bottom">
                    <label class="lls-results-header__field-label lls-columns-12 lls-columns-6--md lls-columns-4--lg lls-columns-2--xl" *ngFor="let searchTerm of searchTerms; index as i;">
                        <span class="lls-results-header__field-label-text">{{ searchFieldLabels[searchTerm.field] }}</span>
                        <input
                            [(ngModel)]="searchTerm.value"
                            type="text"
                            [placeholder]="searchFieldPlaceholders[searchTerm.field]"
                            class="lls-input-field"
                            [name]="'searchterm-value-' + i"
                        />
                    </label>
                    <div class="lls-results-header__field-label lls-columns-12 lls-columns-6--md lls-columns-4--lg lls-columns-2--xl">
                        <lls-dropdown
                            class="lls-dropdown--option-adder"
                            [options]="fieldOptions"
                            name="add-field"
                            label="Tilføj felt"
                            [featherIconPath]="config.featherIconPath"
                            dropdownIcon="plus-circle"
                            dropdownIconOpen="plus-circle"
                            (change)="addField($event)"
                        ></lls-dropdown>
                        <!-- TODO: on selection made, show label -->
                    </div>
                </div>
            </div>
            <div class="lls-results-header__field-label lls-columns-12 lls-columns-3--md lls-columns-2--lg lls-columns-2--xl">
                <span class="lls-results-header__field-label-text">Resultattype</span>
                <div class="lls-results-header__checkboxes">
                    <div class="lls-results-header__checkbox-container">
                        <input
                            [(ngModel)]="indexSource"
                            type="checkbox"
                            class="lls-results-header__checkbox"
                            id="indexSource-checkbox"
                            name="indexSource"
                        >
                        <label for="indexSource-checkbox">Kilder</label>
                    </div>
                    <div class="lls-results-header__checkbox-container">
                        <input
                            [(ngModel)]="indexLifecourse"
                            type="checkbox"
                            class="lls-results-header__checkbox"
                            id="indexLifecourse-checkbox"
                            name="indexLifecourse"
                        >
                        <label for="indexLifecourse-checkbox">Livsforløb</label>
                    </div>
                </div>
            </div>
            <div class="lls-results-header__right-section lls-columns-12 lls-columns-3--md lls-columns-2--lg lls-columns-1--xl">
                <button
                    type="submit"
                    class="lls-btn lls-btn--blue"
                >
                    <span>Søg</span>
                    <svg class="lls-icon lls-icon--right">
                        <use [attr.href]="featherSpriteUrl + '#search'"></use>
                    </svg>
                </button>
            </div>
        </form>
    </div>
</section>
<section class="lls-results-filter lls-container">
    <div class="lls-row">
        <div class="lls-columns-6 u-p-2">
            <p>Filter resultater</p>
            <button class="lls-btn lls-btn--outline lls-btn--link" (click)="openSidebar = true">
                <span>Kilder</span>
                <svg class="lls-icon lls-icon--right">
                    <use [attr.href]="featherSpriteUrl + '#chevron-right'"></use>
                </svg>
            </button>
            <lls-filter-sidebar
                [openSidebar]="openSidebar"
                [featherIconPath]="config.featherIconPath"
                (closeSidebar)="onClose($event)"
                (change)="addFilter($event)"
            ></lls-filter-sidebar>
            <div class="lls-results-filter__items">
                <button
                    *ngFor="let filterItem of filterItems; index as i;"
                    class="lls-btn lls-btn--small lls-btn--grey u-mr-2 u-mt-2"
                >
                    <span>{{ filterItem.field.label }}</span>
                    <svg class="lls-icon lls-icon--left" (click)="removeFilter(filterItem.field)">
                        <use [attr.href]="config.featherIconPath + '#x'"></use>
                      </svg>
                </button>
            </div>
        </div>
        <div class="lls-columns-6 u-p-2">
            <div class="u-text-right">Viser 10 af {{ searchResult.totalHits }} resultater</div>
        </div>
    </div>
</section>
<div class="lls-container">
    <div>
        <div>
            <!-- <ul class="nav nav-tabs nav-fill">
                <li class="nav-item d-flex">
                    <a class="nav-link flex-fill" [routerLink]="['./', { 'page': 1 } ]" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" [queryParams]="searchQueryParams">
                        <p>
                            <strong class="align-middle">Alle</strong>
                        </p>
                        <p>
                            <small>Både livsforløb, og indtastede kilder.</small>
                        </p>
                    </a>
                </li>
                
                <li class="nav-item d-flex">
                    <a class="nav-link flex-fill d-inline align-middle" [routerLink]="['./', { 'page': 1 } ]" routerLinkActive="active" [queryParams]="lifeCourseQueryParams">
                        <span class="align-middle">
                            <p>
                                <strong>Livsforløb</strong><span *ngIf="searchResult.indexHits.lifeCourses"> ({{ searchResult.indexHits.lifeCourses}})</span>
                            </p>
                            <p>
                                <small>Mulige livsforløb sammensat af indtastede kilder.</small>
                            </p>
                        </span>
                    </a>
                </li>
                <li class="nav-item d-flex">
                    <a class="nav-link flex-fill d-inline align-middle" [routerLink]="['./', { 'page': 1 } ]" routerLinkActive="active" [queryParams]="personAppearanceQueryParams">
                        <p>
                            <strong>Indtastede kilder</strong><span *ngIf="searchResult.indexHits.pas"> ({{ searchResult.indexHits.pas}})</span>
                        </p>
                        <p>
                            <small>Personregistreringer fra f.eks. folketællinger og kirkebøger.</small>
                        </p>
                    </a>
                </li>
            </ul> -->

            <div class="p-2 u-text-right">Viser 10 af {{ searchResult.totalHits }} resultater</div>

            <ng-container *ngFor="let hit of searchResult.hits" [ngSwitch]="hit.type">
                <app-person-appearance-item *ngSwitchCase="'pas'" class="mx-2" [item]="hit.pa"></app-person-appearance-item>
                <app-life-course-item *ngSwitchCase="'lifecourses'" class="mx-2" [item]="hit.pas" [lifecourse-id]="hit.life_course_id"></app-life-course-item>
            </ng-container>

            <nav>
                <ul class="pagination justify-content-center mb-0">
                    <li class="page-item" [ngClass]="{ disabled: pagination.current === 1}">
                        <a class="page-link" [tabindex]=" pagination.current === 1 ? -1 : 0" [routerLink]="['./', { 'size': pagination.size, 'page': pagination.current - 1 } ]" [queryParams]="queryParams">Forrige</a>
                    </li>
                    
                    <li *ngFor="let page of pagination.navigationPages" class="page-item" [ngClass]="{ disabled: pagination.current === page }">
                        <a class="page-link" [routerLink]="['./', { 'size': pagination.size, 'page': page } ]" [queryParams]="queryParams">{{ page }}</a>
                    </li>

                    <li class="page-item" [ngClass]="{ disabled: pagination.current >= pagination.last }">
                        <a class="page-link" [tabindex]="pagination.current >= pagination.last ? -1 : 0"  [routerLink]="['./', { 'size': pagination.size, 'page': pagination.last } ]" [queryParams]="queryParams">Næste</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>
